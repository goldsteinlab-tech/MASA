% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main_function.R
\name{calcNormalizedExpectedObservedCounts}
\alias{calcNormalizedExpectedObservedCounts}
\title{calcNormalizedExpectedObservedCounts}
\usage{
calcNormalizedExpectedObservedCounts(
  sites,
  S,
  cache,
  basehalfwidth,
  halfwidth,
  scalefactor,
  motifbuffer = 2,
  halfflankingregionwidth = 50,
  heatmapout = ""
)
}
\arguments{
\item{sites}{Motif sites to analyze}

\item{S}{AggregationPlotData object with required data}

\item{cache}{Cache directory}

\item{basehalfwidth}{Base window size}

\item{halfwidth}{Window size around motif}

\item{scalefactor}{Normalization factor}

\item{motifbuffer}{Buffer size around motif}

\item{halfflankingregionwidth}{Flanking region size}

\item{heatmapout}{Output file for heatmap (optional)}
}
\value{
List with normalized observed/expected counts and accessibility metrics
}
\description{
This function calculates the normalized observed and expected cut counts around motif sites.
It is a core step for footprinting analysis.
}
\details{
Main steps:
\itemize{
\item For each motif site, extract observed and expected cut counts in a window around the motif.
\item Normalize these counts using a scale factor.
\item Compute the log2 ratio of observed/expected counts (accessibility ratio) for the motif and flanking regions.
\item Summarize the accessibility signal inside the motif and in the flanking regions.
}

Outputs:
\itemize{
\item A list containing:
\itemize{
\item mobs: mean observed cut counts profile
\item mexp: mean expected cut counts profile
\item logratio: log2(observed/expected) profile (accessibility ratio)
\item baselogratio: mean logratio in flanking regions (background accessibility)
\item motiflogratio: mean logratio inside the motif (footprint accessibility)
}
}

These results are used to quantify motif accessibility and footprint depth for downstream analysis.
}
